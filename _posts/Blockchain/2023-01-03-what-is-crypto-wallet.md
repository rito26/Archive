--- 
title: 암호화폐 지갑과 코인 거래
author: rito26 
date: 2023-01-03 21:12:23 +09:00 
categories: [Blockchain] 
tags: [] 
math: true 
mermaid: true 
--- 

# 암호화폐 거래
---

## 소유와 거래의 개념
- 블록체인 네트워크의 암호화폐를 소유한다는 것은 내가 실제로 무언가를 갖고 있는 것이 아니라,
  그저 해당 암호화폐에 내 정보(지갑 주소 등)를 기입하는 것을 의미한다.
- 거래도 마찬가지로 해당 암호화폐 내의 데이터에 명시된 소유자 정보를 변경하는 것을 뜻한다.

<br>



# 암호화폐 지갑(Crypto Wallet)
--- 

## 암호화폐 지갑이란?
- 해당 블록체인 네트워크에서 코인, 토큰 등의 자산에 '소유자 정보'로 등록할 수 있는
  `긴 해시 문자열`을 의미한다.
- 정확히는 '지갑의 주소'

## 지갑의 생성
- 비대칭적 암호화(Asymmetric encryption)을 통해 생성된다.
- 다시 말해, 공개키(Public key)와 개인키(Private Key)의 개념이다.
- 지갑을 생성한다는 것은, 사용자 입력(개인키)을 통해 공개키를 만든다는 것을 의미한다.
- 그리고 공개키를 해싱하여 지갑 주소를 만들어낸다.

## 추가: 코인, 토큰의 주소
- 코인과 토큰은 모두 고유 주소를 갖고 있다.
- 이 주소는 소유자의 공개키를 해싱하여 얻어낸 값으로 저장한다.(코인마다 다름)

## 정리
- <https://brunch.co.kr/@doyoulovez/7>
- 지갑 비밀번호 = 개인키 접근 암호 (지갑 관리 플랫폼에서 보관, 블록체인 네트워크 밖의 별도 시스템에 저장됨)

-           (키 생성 요청)  -> 개인키        : 256비트의 난수
- 개인키 -> (타원곡선 함수) -> 공개키
- 공개키 -> (해시 함수)     -> 지갑 주소      : 주소 생성 방식은 코인마다 다름
- 공개키 -> (해시 함수)     -> 코인/토큰 주소

<br>


# 코인(+ 토큰) 거래
---

## 거래 메커니즘

- 트랜잭션 생성(서명은 반드시 판매자가 수행, 트랜잭션 생성은 누구나 가능)

  - 암호화되지 않은 `거래 메시지`
    - 구성 : 판매자의 공개키 + 구매자의 공개키 + 데이터(전달되는 화폐 양이나 토큰 정보 등)

  - `거래 메시지`를 해싱하여 `메시지 해시` 생성
    
    = 트랜잭션 ID or 트랜잭션 해시

  - 위 `메시지 해시`를 판매자의 개인키를 통해 암호화하여 `디지털 서명` 생성
    
    = 이전 소유자의 판매 동의 서명 정보

  - 트랜잭션 구성 : `거래 메시지` + `메시지 해시` + `디지털 서명`

<br>

- 블록에 트랜잭션 추가 (거래 완료)

<br>

## 트랜잭션 유효성 검증
  - `디지털 서명`을 `판매자의 공개키`로 복호화한 결과가 `메시지 해시`와 일치하면 검증 성공

<br>

## 소유자 인증 
- 어떤 데이터(`원문`)를 `소유자의 개인키`로 암호화하여 `암호문`을 생성했을 때, 

  어느 누구든 `암호문`을 `소유자의 공개키`로 복호화하여 `원문`과 일치함을 확인하면 인증 성공

- 이 때, `원문`이 `소유자의 공개키`인 경우 가장 빠르게 인증 가능

<br>

## 소유자 인증 쉽게 정리
- 소유자가 `소유자의 공개키`를 개인키로 암호화한 `암호문` 제출

- 누군가가 `암호문`을 `소유자의 공개키`로 복호화하여 얻어낸 `평문`이

  `블록의 마지막 트랜잭션 내에 저장된 소유자의 공개키`와 일치함을 확인하면 인증 성공

<br>


## 참고: RSA 디지털 서명 및 검증 과정
- 서명: 발신자
  - `원문`    -> (SHA256 해싱)     -> `암호문1` 생성
  - `암호문1` -> (개인키로 암호화) -> `서명`    생성

- 전달
  - 발신자 -> 수신자
  - 내용 : `암호문1` + `서명` + `공개키`

- 검증: 수신자
  - `서명` -> (공개키로 복호화) -> `암호문2` 생성
  - `암호문1`, `암호문2` 비교   -> 일치하면 검증 완료

<br>


<!------------------------------------------------------------------> 

# References
--- 
- <https://www.youtube.com/watch?v=4uBWSPw-Vd8> 
- <https://brunch.co.kr/@doyoulovez/7> ★
- <https://organicmedialab.com/2014/02/20/bitcoin-addresses-transactions-and-wallets/>
- <https://bitkunst.tistory.com/entry/BlockChain-개인키-공개키-서명-지갑계정>

- <https://www.blockchaintoday.co.kr/news/articleView.html?idxno=24194>
- <https://www.banksalad.com/contents/쉽게-설명하는-블록체인-공개키와-개인키-Nhtdy>
- <https://ko.vpnmentor.com/blog/비트코인에대한모든것비트코인상세가이드/>

- <https://developer.bitcoin.org/devguide/transactions.html>
